
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://klust.github.io/LUMI-BE-training-materials/intro-202310xx/11_Containers/">
      
      
        <link rel="prev" href="../10_Lustre/">
      
      
        <link rel="next" href="../A01_Slurm_issues/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.11">
    
    
      
        <title>Containers - LUMI-BE training materials</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.fad675c6.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--demo:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M0 192h176V0h-16C71.6 0 0 71.6 0 160v32zm0 32v128c0 88.4 71.6 160 160 160h64c88.4 0 160-71.6 160-160V224H0zm384-32v-32C384 71.6 312.4 0 224 0h-16v192h176z"/></svg>');--md-admonition-icon--exercise:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M78.6 5c-9.5-7.4-23-6.5-31.6 2L7 47c-8.5 8.5-9.4 22-2.1 31.6l80 104c4.5 5.9 11.6 9.4 19 9.4H158l109 109c-14.7 29-10 65.4 14.3 89.6l112 112c12.5 12.5 32.8 12.5 45.3 0l64-64c12.5-12.5 12.5-32.8 0-45.3l-112-112c-24.2-24.2-60.6-29-89.6-14.3L192 158v-54c0-7.5-3.5-14.5-9.4-19L78.6 5zM19.9 396.1C7.2 408.8 0 426.1 0 444.1 0 481.6 30.4 512 67.9 512c18 0 35.3-7.2 48-19.9l117.8-117.8c-7.8-20.9-9-43.6-3.6-65.1l-61.7-61.7L19.9 396.1zM512 144c0-10.5-1.1-20.7-3.2-30.5-2.4-11.2-16.1-14.1-24.2-6l-63.9 63.9c-3 3-7.1 4.7-11.3 4.7H352c-8.8 0-16-7.2-16-16v-57.5c0-4.2 1.7-8.3 4.7-11.3l63.9-63.9c8.1-8.1 5.2-21.8-6-24.2C388.7 1.1 378.5 0 368 0c-79.5 0-144 64.5-144 144v.8l85.3 85.3c36-9.1 75.8.5 104 28.7l15.7 15.7c49-23 83-72.8 83-130.5zM56 432a24 24 0 1 1 48 0 24 24 0 1 1-48 0z"/></svg>');--md-admonition-icon--remark:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M256 448c141.4 0 256-93.1 256-208S397.4 32 256 32 0 125.1 0 240c0 45.1 17.7 86.8 47.7 120.9-1.9 24.5-11.4 46.3-21.4 62.9-5.5 9.2-11.1 16.6-15.2 21.6-2.1 2.5-3.7 4.4-4.9 5.7-.6.6-1 1.1-1.3 1.4l-.3.3c-4.6 4.6-5.9 11.4-3.4 17.4 2.5 6 8.3 9.9 14.8 9.9 28.7 0 57.6-8.9 81.6-19.3 22.9-10 42.4-21.9 54.3-30.6 31.8 11.5 67 17.9 104.1 17.9zM128 208a32 32 0 1 1 0 64 32 32 0 1 1 0-64zm128 0a32 32 0 1 1 0 64 32 32 0 1 1 0-64zm96 32a32 32 0 1 1 64 0 32 32 0 1 1-64 0z"/></svg>');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M320 0c17.7 0 32 14.3 32 32v64h120c39.8 0 72 32.2 72 72v272c0 39.8-32.2 72-72 72H168c-39.8 0-72-32.2-72-72V168c0-39.8 32.2-72 72-72h120V32c0-17.7 14.3-32 32-32zM208 384c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16h-32zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16h-32zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16h-32zM264 256a40 40 0 1 0-80 0 40 40 0 1 0 80 0zm152 40a40 40 0 1 0 0-80 40 40 0 1 0 0 80zM48 224h16v192H48c-26.5 0-48-21.5-48-48v-96c0-26.5 21.5-48 48-48zm544 0c26.5 0 48 21.5 48 48v96c0 26.5-21.5 48-48 48h-16V224h16z"/></svg>');--md-admonition-icon--audience:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M72 88a56 56 0 1 1 112 0 56 56 0 1 1-112 0zm-8 157.7c-10 11.2-16 26.1-16 42.3s6 31.1 16 42.3v-84.6zm144.4-49.3C178.7 222.7 160 261.2 160 304c0 34.3 12 65.8 32 90.5V416c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32v-26.8C26.2 371.2 0 332.7 0 288c0-61.9 50.1-112 112-112h32c24 0 46.2 7.5 64.4 20.3zM448 416v-21.5c20-24.7 32-56.2 32-90.5 0-42.8-18.7-81.3-48.4-107.7C449.8 183.5 472 176 496 176h32c61.9 0 112 50.1 112 112 0 44.7-26.2 83.2-64 101.2V416c0 17.7-14.3 32-32 32h-64c-17.7 0-32-14.3-32-32zm8-328a56 56 0 1 1 112 0 56 56 0 1 1-112 0zm120 157.7v84.7c10-11.3 16-26.1 16-42.3s-6-31.1-16-42.3zM320 32a64 64 0 1 1 0 128 64 64 0 1 1 0-128zm-80 272c0 16.2 6 31 16 42.3v-84.6c-10 11.3-16 26.1-16 42.3zm144-42.3v84.7c10-11.3 16-26.1 16-42.3s-6-31.1-16-42.3zm64 42.3c0 44.7-26.2 83.2-64 101.2V448c0 17.7-14.3 32-32 32h-64c-17.7 0-32-14.3-32-32v-42.8c-37.8-18-64-56.5-64-101.2 0-61.9 50.1-112 112-112h32c61.9 0 112 50.1 112 112z"/></svg>');--md-admonition-icon--solution:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M234.7 42.7 197 56.8c-3 1.1-5 4-5 7.2s2 6.1 5 7.2l37.7 14.1 14.1 37.7c1.1 3 4 5 7.2 5s6.1-2 7.2-5l14.1-37.7L315 71.2c3-1.1 5-4 5-7.2s-2-6.1-5-7.2l-37.7-14.1L263.2 5c-1.1-3-4-5-7.2-5s-6.1 2-7.2 5l-14.1 37.7zM46.1 395.4c-18.7 18.7-18.7 49.1 0 67.9l34.6 34.6c18.7 18.7 49.1 18.7 67.9 0l381.3-381.4c18.7-18.7 18.7-49.1 0-67.9l-34.6-34.5c-18.7-18.7-49.1-18.7-67.9 0L46.1 395.4zM484.6 82.6l-105 105-23.3-23.3 105-105 23.3 23.3zM7.5 117.2C3 118.9 0 123.2 0 128s3 9.1 7.5 10.8L64 160l21.2 56.5c1.7 4.5 6 7.5 10.8 7.5s9.1-3 10.8-7.5L128 160l56.5-21.2c4.5-1.7 7.5-6 7.5-10.8s-3-9.1-7.5-10.8L128 96l-21.2-56.5c-1.7-4.5-6-7.5-10.8-7.5s-9.1 3-10.8 7.5L64 96 7.5 117.2zm352 256c-4.5 1.7-7.5 6-7.5 10.8s3 9.1 7.5 10.8L416 416l21.2 56.5c1.7 4.5 6 7.5 10.8 7.5s9.1-3 10.8-7.5L480 416l56.5-21.2c4.5-1.7 7.5-6 7.5-10.8s-3-9.1-7.5-10.8L480 352l-21.2-56.5c-1.7-4.5-6-7.5-10.8-7.5s-9.1 3-10.8 7.5L416 352l-56.5 21.2z"/></svg>');--md-admonition-icon--technical:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M160 96a96 96 0 1 1 192 0 96 96 0 1 1-192 0zm80 152v264l-48.4-24.2c-20.9-10.4-43.5-17-66.8-19.3l-96-9.6C12.5 457.2 0 443.5 0 427V224c0-17.7 14.3-32 32-32h30.3c63.6 0 125.6 19.6 177.7 56zm32 264V248c52.1-36.4 114.1-56 177.7-56H480c17.7 0 32 14.3 32 32v203c0 16.4-12.5 30.2-28.8 31.8l-96 9.6c-23.2 2.3-45.9 8.9-66.8 19.3L272 512z"/></svg>');--md-admonition-icon--intermediate:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M320 32c-8.1 0-16.1 1.4-23.7 4.1L15.8 137.4C6.3 140.9 0 149.9 0 160s6.3 19.1 15.8 22.6l57.9 20.9C57.3 229.3 48 259.8 48 291.9V320c0 28.4-10.8 57.7-22.3 80.8-6.5 13-13.9 25.8-22.5 37.6-3.2 4.3-4.1 9.9-2.3 15s6 8.9 11.2 10.2l64 16c4.2 1.1 8.7.3 12.4-2s6.3-6.1 7.1-10.4c8.6-42.8 4.3-81.2-2.1-108.7-3.2-14.2-7.5-28.7-13.5-42v-24.6c0-30.2 10.2-58.7 27.9-81.5 12.9-15.5 29.6-28 49.2-35.7l157-61.7c8.2-3.2 17.5.8 20.7 9s-.8 17.5-9 20.7l-157 61.7c-12.4 4.9-23.3 12.4-32.2 21.6l159.6 57.6c7.6 2.7 15.6 4.1 23.7 4.1s16.1-1.4 23.7-4.1l280.6-101c9.5-3.4 15.8-12.5 15.8-22.6s-6.3-19.1-15.8-22.6L343.7 36.1c-7.6-2.7-15.6-4.1-23.7-4.1zM128 408c0 35.3 86 72 192 72s192-36.7 192-72l-15.3-145.4L354.5 314c-11.1 4-22.8 6-34.5 6s-23.5-2-34.5-6l-142.2-51.4L128 408z"/></svg>');--md-admonition-icon--advanced:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M219.3.5c3.1-.6 6.3-.6 9.4 0l200 40C439.9 42.7 448 52.6 448 64s-8.1 21.3-19.3 23.5L352 102.9V160c0 70.7-57.3 128-128 128S96 230.7 96 160v-57.1l-48-9.6v65.1l15.7 78.4c.9 4.7-.3 9.6-3.3 13.3S52.8 256 48 256H16c-4.8 0-9.3-2.1-12.4-5.9s-4.3-8.6-3.3-13.3L16 158.4V86.6C6.5 83.3 0 74.3 0 64c0-11.4 8.1-21.3 19.3-23.5l200-40zM111.9 327.7c10.5-3.4 21.8.4 29.4 8.5l71 75.5c6.3 6.7 17 6.7 23.3 0l71-75.5c7.6-8.1 18.9-11.9 29.4-8.5 65 20.9 112 81.7 112 153.6 0 17-13.8 30.7-30.7 30.7H30.7C13.8 512 0 498.2 0 481.3c0-71.9 47-132.7 111.9-153.6z"/></svg>');--md-admonition-icon--lumi-be:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M48 0C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h96v-80c0-26.5 21.5-48 48-48s48 21.5 48 48v80h96c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48H48zm16 240c0-8.8 7.2-16 16-16h32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16H80c-8.8 0-16-7.2-16-16v-32zm112-16h32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16h-32c-8.8 0-16-7.2-16-16v-32c0-8.8 7.2-16 16-16zm80 16c0-8.8 7.2-16 16-16h32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16h-32c-8.8 0-16-7.2-16-16v-32zM80 96h32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16H80c-8.8 0-16-7.2-16-16v-32c0-8.8 7.2-16 16-16zm80 16c0-8.8 7.2-16 16-16h32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16h-32c-8.8 0-16-7.2-16-16v-32zm112-16h32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16h-32c-8.8 0-16-7.2-16-16v-32c0-8.8 7.2-16 16-16zM448 0c-17.7 0-32 14.3-32 32v480h64V192h144c8.8 0 16-7.2 16-16V48c0-8.8-7.2-16-16-16H480c0-17.7-14.3-32-32-32z"/></svg>');--md-admonition-icon--nice-to-know:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M297.2 248.9c14.4-20.6 22.8-45.7 22.8-72.9 0-70.7-57.3-128-128-128S64 105.3 64 176c0 27.2 8.4 52.3 22.8 72.9 3.7 5.3 8.1 11.3 12.8 17.7 12.9 17.7 28.3 38.9 39.8 59.8 10.4 19 15.7 38.8 18.3 57.5H109c-2.2-12-5.9-23.7-11.8-34.5-9.9-18-22.2-34.9-34.5-51.8-5.2-7.1-10.4-14.2-15.4-21.4C27.6 247.9 16 213.3 16 176 16 78.8 94.8 0 192 0s176 78.8 176 176c0 37.3-11.6 71.9-31.4 100.3-5 7.2-10.2 14.3-15.4 21.4-12.3 16.8-24.6 33.7-34.5 51.8-5.9 10.8-9.6 22.5-11.8 34.5h-48.5c2.6-18.7 7.9-38.6 18.3-57.5 11.5-20.9 26.9-42.1 39.8-59.8 4.7-6.4 9-12.4 12.7-17.7zM192 128c-26.5 0-48 21.5-48 48 0 8.8-7.2 16-16 16s-16-7.2-16-16c0-44.2 35.8-80 80-80 8.8 0 16 7.2 16 16s-7.2 16-16 16zm0 384c-44.2 0-80-35.8-80-80v-16h160v16c0 44.2-35.8 80-80 80z"/></svg>');}</style>



    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="lumi-be" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#containers-on-lumi" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="LUMI-BE training materials" class="md-header__button md-logo" aria-label="LUMI-BE training materials" data-md-component="logo">
      
  
  <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Created with Inkscape (http://www.inkscape.org/) -->

<svg
   width="800"
   height="220"
   viewBox="0 0 211.66666 58.208333"
   version="1.1"
   id="svg1706"
   inkscape:version="1.2.2 (b0a84865, 2022-12-01)"
   sodipodi:docname="logo.svg"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg">
  <sodipodi:namedview
     id="namedview1708"
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1.0"
     inkscape:showpageshadow="2"
     inkscape:pageopacity="0.0"
     inkscape:pagecheckerboard="0"
     inkscape:deskcolor="#d1d1d1"
     inkscape:document-units="mm"
     showgrid="false"
     inkscape:zoom="0.914906"
     inkscape:cx="372.16938"
     inkscape:cy="24.046186"
     inkscape:window-width="2400"
     inkscape:window-height="988"
     inkscape:window-x="767"
     inkscape:window-y="174"
     inkscape:window-maximized="0"
     inkscape:current-layer="layer1" />
  <defs
     id="defs1703" />
  <g
     inkscape:label="Laag 1"
     inkscape:groupmode="layer"
     id="layer1">
    <g
       aria-label="LUMI-BE"
       id="text4785"
       style="font-size:50.8px;line-height:1.25;-inkscape-font-specification:'sans-serif, Normal';fill:#f2f2f2;stroke-width:0.264583">
      <path
         d="M 23.366015,48.011253 H -7.4505806e-8 V 11.077074 H 4.911328 v 32.568554 h 18.454687 z"
         id="path6569" />
      <path
         d="m 56.083398,33.17805 q 0,4.01836 -0.892969,7.019727 -0.868164,2.976562 -2.877343,4.960937 -1.909961,1.885157 -4.464844,2.753321 -2.554883,0.868164 -5.953125,0.868164 -3.472656,0 -6.052344,-0.917774 -2.579687,-0.917773 -4.34082,-2.703711 -2.00918,-2.033984 -2.902148,-4.911328 -0.868164,-2.877343 -0.868164,-7.069336 V 11.077074 h 4.911328 v 22.349023 q 0,3.001367 0.396875,4.737696 0.421679,1.736328 1.389062,3.150195 1.091406,1.612304 2.951758,2.430859 1.885156,0.818555 4.514453,0.818555 2.654101,0 4.514453,-0.79375 1.860352,-0.818555 2.976562,-2.455664 0.967383,-1.413867 1.364258,-3.224609 0.42168,-1.835547 0.42168,-4.539258 V 11.077074 h 4.911328 z"
         id="path6571" />
      <path
         d="M 98.350579,48.011253 H 93.439251 V 16.18684 L 83.170111,37.841332 H 80.243158 L 70.048431,16.18684 V 48.011253 H 65.459564 V 11.077074 h 6.697266 l 9.84746,20.563086 9.525,-20.563086 h 6.821289 z"
         id="path6573" />
      <path
         d="m 121.29492,48.011253 h -14.58515 v -3.770312 h 4.83691 V 14.847387 h -4.83691 v -3.770313 h 14.58515 v 3.770313 h -4.83691 v 29.393554 h 4.83691 z"
         id="path6575" />
      <path
         d="m 143.22226,34.095824 h -15.47812 v -4.489648 h 15.47812 z"
         id="path6577" />
      <path
         d="m 179.83398,36.650707 q 0,2.75332 -1.0418,4.861718 -1.04179,2.108399 -2.80293,3.472657 -2.08359,1.637109 -4.58886,2.33164 -2.48047,0.694531 -6.3252,0.694531 H 151.97832 V 11.077074 h 10.93886 q 4.04317,0 6.05235,0.297656 2.00918,0.297657 3.84472,1.240235 2.03399,1.066601 2.95176,2.75332 0.91778,1.661914 0.91778,3.993555 0,2.629297 -1.33946,4.489648 -1.33945,1.835547 -3.57187,2.951758 v 0.198437 q 3.74551,0.768946 5.90351,3.299024 2.15801,2.505273 2.15801,6.35 z m -8.25996,-16.643945 q 0,-1.339454 -0.44648,-2.257227 -0.44649,-0.917773 -1.43868,-1.488281 -1.16582,-0.669727 -2.82773,-0.818555 -1.66191,-0.173633 -4.11758,-0.173633 h -5.8539 v 10.666016 h 6.35 q 2.30683,0 3.67109,-0.223242 1.36426,-0.248047 2.53008,-0.992188 1.16582,-0.74414 1.63711,-1.909961 0.49609,-1.190625 0.49609,-2.802929 z m 3.1502,16.842382 q 0,-2.232422 -0.66973,-3.54707 -0.66973,-1.314649 -2.43086,-2.232422 -1.19063,-0.620117 -2.90215,-0.79375 -1.68672,-0.198437 -4.11758,-0.198437 h -7.71425 v 13.741796 h 6.49882 q 3.22461,0 5.2834,-0.322461 2.05879,-0.347265 3.37344,-1.240234 1.38906,-0.967383 2.03398,-2.207617 0.64493,-1.240235 0.64493,-3.199805 z"
         id="path6579" />
      <path
         d="m 211.13749,48.011253 h -24.3334 V 11.077074 h 24.3334 v 4.365625 h -19.42207 v 10.120313 h 19.42207 v 4.365624 h -19.42207 v 13.716992 h 19.42207 z"
         id="path6581" />
    </g>
    <rect
       style="fill:#f2f2f2;stroke:none;stroke-width:0.988271;fill-opacity:1"
       id="rect4936"
       width="211.66667"
       height="3.175"
       x="0"
       y="0" />
    <rect
       style="fill:#f2f2f2;stroke:none;stroke-width:0.988271;fill-opacity:1"
       id="rect4936-7"
       width="211.66667"
       height="3.175"
       x="-8.3049135e-06"
       y="55.033333" />
  </g>
</svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LUMI-BE training materials
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Containers
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="LUMI-BE training materials" class="md-nav__button md-logo" aria-label="LUMI-BE training materials" data-md-component="logo">
      
  
  <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Created with Inkscape (http://www.inkscape.org/) -->

<svg
   width="800"
   height="220"
   viewBox="0 0 211.66666 58.208333"
   version="1.1"
   id="svg1706"
   inkscape:version="1.2.2 (b0a84865, 2022-12-01)"
   sodipodi:docname="logo.svg"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg">
  <sodipodi:namedview
     id="namedview1708"
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1.0"
     inkscape:showpageshadow="2"
     inkscape:pageopacity="0.0"
     inkscape:pagecheckerboard="0"
     inkscape:deskcolor="#d1d1d1"
     inkscape:document-units="mm"
     showgrid="false"
     inkscape:zoom="0.914906"
     inkscape:cx="372.16938"
     inkscape:cy="24.046186"
     inkscape:window-width="2400"
     inkscape:window-height="988"
     inkscape:window-x="767"
     inkscape:window-y="174"
     inkscape:window-maximized="0"
     inkscape:current-layer="layer1" />
  <defs
     id="defs1703" />
  <g
     inkscape:label="Laag 1"
     inkscape:groupmode="layer"
     id="layer1">
    <g
       aria-label="LUMI-BE"
       id="text4785"
       style="font-size:50.8px;line-height:1.25;-inkscape-font-specification:'sans-serif, Normal';fill:#f2f2f2;stroke-width:0.264583">
      <path
         d="M 23.366015,48.011253 H -7.4505806e-8 V 11.077074 H 4.911328 v 32.568554 h 18.454687 z"
         id="path6569" />
      <path
         d="m 56.083398,33.17805 q 0,4.01836 -0.892969,7.019727 -0.868164,2.976562 -2.877343,4.960937 -1.909961,1.885157 -4.464844,2.753321 -2.554883,0.868164 -5.953125,0.868164 -3.472656,0 -6.052344,-0.917774 -2.579687,-0.917773 -4.34082,-2.703711 -2.00918,-2.033984 -2.902148,-4.911328 -0.868164,-2.877343 -0.868164,-7.069336 V 11.077074 h 4.911328 v 22.349023 q 0,3.001367 0.396875,4.737696 0.421679,1.736328 1.389062,3.150195 1.091406,1.612304 2.951758,2.430859 1.885156,0.818555 4.514453,0.818555 2.654101,0 4.514453,-0.79375 1.860352,-0.818555 2.976562,-2.455664 0.967383,-1.413867 1.364258,-3.224609 0.42168,-1.835547 0.42168,-4.539258 V 11.077074 h 4.911328 z"
         id="path6571" />
      <path
         d="M 98.350579,48.011253 H 93.439251 V 16.18684 L 83.170111,37.841332 H 80.243158 L 70.048431,16.18684 V 48.011253 H 65.459564 V 11.077074 h 6.697266 l 9.84746,20.563086 9.525,-20.563086 h 6.821289 z"
         id="path6573" />
      <path
         d="m 121.29492,48.011253 h -14.58515 v -3.770312 h 4.83691 V 14.847387 h -4.83691 v -3.770313 h 14.58515 v 3.770313 h -4.83691 v 29.393554 h 4.83691 z"
         id="path6575" />
      <path
         d="m 143.22226,34.095824 h -15.47812 v -4.489648 h 15.47812 z"
         id="path6577" />
      <path
         d="m 179.83398,36.650707 q 0,2.75332 -1.0418,4.861718 -1.04179,2.108399 -2.80293,3.472657 -2.08359,1.637109 -4.58886,2.33164 -2.48047,0.694531 -6.3252,0.694531 H 151.97832 V 11.077074 h 10.93886 q 4.04317,0 6.05235,0.297656 2.00918,0.297657 3.84472,1.240235 2.03399,1.066601 2.95176,2.75332 0.91778,1.661914 0.91778,3.993555 0,2.629297 -1.33946,4.489648 -1.33945,1.835547 -3.57187,2.951758 v 0.198437 q 3.74551,0.768946 5.90351,3.299024 2.15801,2.505273 2.15801,6.35 z m -8.25996,-16.643945 q 0,-1.339454 -0.44648,-2.257227 -0.44649,-0.917773 -1.43868,-1.488281 -1.16582,-0.669727 -2.82773,-0.818555 -1.66191,-0.173633 -4.11758,-0.173633 h -5.8539 v 10.666016 h 6.35 q 2.30683,0 3.67109,-0.223242 1.36426,-0.248047 2.53008,-0.992188 1.16582,-0.74414 1.63711,-1.909961 0.49609,-1.190625 0.49609,-2.802929 z m 3.1502,16.842382 q 0,-2.232422 -0.66973,-3.54707 -0.66973,-1.314649 -2.43086,-2.232422 -1.19063,-0.620117 -2.90215,-0.79375 -1.68672,-0.198437 -4.11758,-0.198437 h -7.71425 v 13.741796 h 6.49882 q 3.22461,0 5.2834,-0.322461 2.05879,-0.347265 3.37344,-1.240234 1.38906,-0.967383 2.03398,-2.207617 0.64493,-1.240235 0.64493,-3.199805 z"
         id="path6579" />
      <path
         d="m 211.13749,48.011253 h -24.3334 V 11.077074 h 24.3334 v 4.365625 h -19.42207 v 10.120313 h 19.42207 v 4.365624 h -19.42207 v 13.716992 h 19.42207 z"
         id="path6581" />
    </g>
    <rect
       style="fill:#f2f2f2;stroke:none;stroke-width:0.988271;fill-opacity:1"
       id="rect4936"
       width="211.66667"
       height="3.175"
       x="0"
       y="0" />
    <rect
       style="fill:#f2f2f2;stroke:none;stroke-width:0.988271;fill-opacity:1"
       id="rect4936-7"
       width="211.66667"
       height="3.175"
       x="-8.3049135e-06"
       y="55.033333" />
  </g>
</svg>

    </a>
    LUMI-BE training materials
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    LUMI Intro
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            LUMI Intro
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../00_Introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro to the notes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../01_Architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../02_CPE/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Programming Environment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../03_LUMI_access/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting access
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../04_Modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../05_Software_stacks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Software stacks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../06_Exercises_1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exercises 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../07_Slurm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Slurm on LUMI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../08_Binding/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Binding
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../09_Exercises_2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exercises 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../10_Lustre/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lustre
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Containers
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Containers
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-are-we-talking-about-in-this-chapter" class="md-nav__link">
    <span class="md-ellipsis">
      What are we talking about in this chapter?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-do-containers-not-provide" class="md-nav__link">
    <span class="md-ellipsis">
      What do containers not provide
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#but-what-can-they-then-do-on-lumi" class="md-nav__link">
    <span class="md-ellipsis">
      But what can they then do on LUMI?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#managing-containers" class="md-nav__link">
    <span class="md-ellipsis">
      Managing containers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interacting-with-containers" class="md-nav__link">
    <span class="md-ellipsis">
      Interacting with containers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-containers-on-lumi" class="md-nav__link">
    <span class="md-ellipsis">
      Running containers on LUMI
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enhancements-to-the-environment" class="md-nav__link">
    <span class="md-ellipsis">
      Enhancements to the environment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Enhancements to the environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bindings-for-singularity" class="md-nav__link">
    <span class="md-ellipsis">
      Bindings for singularity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vnc-container" class="md-nav__link">
    <span class="md-ellipsis">
      VNC container
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cotainr-build-conda-containers-on-lumi" class="md-nav__link">
    <span class="md-ellipsis">
      cotainr: Build Conda containers on LUMI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#container-wrapper-for-python-packages-and-conda" class="md-nav__link">
    <span class="md-ellipsis">
      Container wrapper for Python packages and conda
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-build-ai-containers" class="md-nav__link">
    <span class="md-ellipsis">
      Pre-build AI containers
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion-container-limitations-on-lumi" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion: Container limitations on LUMI
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../12_Support" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Support
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../A01_Slurm_issues/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A1 Slurm issues
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../A02_Documentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A2 Documentation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-are-we-talking-about-in-this-chapter" class="md-nav__link">
    <span class="md-ellipsis">
      What are we talking about in this chapter?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-do-containers-not-provide" class="md-nav__link">
    <span class="md-ellipsis">
      What do containers not provide
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#but-what-can-they-then-do-on-lumi" class="md-nav__link">
    <span class="md-ellipsis">
      But what can they then do on LUMI?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#managing-containers" class="md-nav__link">
    <span class="md-ellipsis">
      Managing containers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interacting-with-containers" class="md-nav__link">
    <span class="md-ellipsis">
      Interacting with containers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-containers-on-lumi" class="md-nav__link">
    <span class="md-ellipsis">
      Running containers on LUMI
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enhancements-to-the-environment" class="md-nav__link">
    <span class="md-ellipsis">
      Enhancements to the environment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Enhancements to the environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bindings-for-singularity" class="md-nav__link">
    <span class="md-ellipsis">
      Bindings for singularity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vnc-container" class="md-nav__link">
    <span class="md-ellipsis">
      VNC container
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cotainr-build-conda-containers-on-lumi" class="md-nav__link">
    <span class="md-ellipsis">
      cotainr: Build Conda containers on LUMI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#container-wrapper-for-python-packages-and-conda" class="md-nav__link">
    <span class="md-ellipsis">
      Container wrapper for Python packages and conda
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pre-build-ai-containers" class="md-nav__link">
    <span class="md-ellipsis">
      Pre-build AI containers
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion-container-limitations-on-lumi" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion: Container limitations on LUMI
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="containers-on-lumi">Containers on LUMI<a class="headerlink" href="#containers-on-lumi" title="Permanent link">&para;</a></h1>
<h2 id="what-are-we-talking-about-in-this-chapter">What are we talking about in this chapter?<a class="headerlink" href="#what-are-we-talking-about-in-this-chapter" title="Permanent link">&para;</a></h2>
<figure style="border: 1px solid #000">
<p><img alt="Containers on LUMI" loading="lazy" src="https://465000095.lumidata.eu/training-materials-web/intro-202310xx/img/LUMI-BE-Intro-202310XX-11-containers/ContainersIntro.png" /></p>
</figure>
<p>Let's now switch to using containers on LUMI. 
This section is about using containers on the login nodes and compute nodes. 
Some of you may have heard that there were plans to also have an OpenShift Kubernetes container cloud
platform for running microservices but at this point it is not clear if and when this will materialize
due to a lack of personpower to get this running and then to support this.</p>
<p>In this section, we will </p>
<ul>
<li>
<p>discuss what to expect from containers on LUMI: what can they do and what can't they do,</p>
</li>
<li>
<p>discuss how to get a container on LUMI,</p>
</li>
<li>
<p>discuss how to run a container on LUMI,</p>
</li>
<li>
<p>and discuss some enhancements we made to the LUMI environment that are based on containers or help
    you use containers.</p>
</li>
</ul>
<p>Remember though that the compute nodes of LUMI are an HPC infrastructure and not a container cloud!</p>
<h2 id="what-do-containers-not-provide">What do containers not provide<a class="headerlink" href="#what-do-containers-not-provide" title="Permanent link">&para;</a></h2>
<figure style="border: 1px solid #000">
<p><img alt="What do containers not provide" loading="lazy" src="https://465000095.lumidata.eu/training-materials-web/intro-202310xx/img/LUMI-BE-Intro-202310XX-11-containers/ContainersNotProvide.png" /></p>
</figure>
<p>What is being discussed in this subsection may be a bit surprising.
Containers are often marketed as a way to provide reproducible science and as an easy way to transfer
software from one machine to another machine. However, containers are neither of those and this becomes 
very clear when using containers built on your typical Mellanox/NVIDIA InfiniBand based clusters with
Intel processors and NVIDIA GPUs on LUMI.</p>
<p>First, computational results are almost never 100% reproducible because of the very nature of how computers
work. You can only expect reproducibility of sequential codes between equal hardware. As soon as you change the
CPU type, some floating point computations may produce slightly different results, and as soon as you go parallel
this may even be the case between two runs on exactly the same hardware and software. Containers may offer more
reproducibility than recompiling software for a different platform, but all you're trying to do is reproducing 
the same wrong result as in particular floating point operations are only an approximation for real numbers. 
When talking about reproducibility, you should think like way experimentalists do: You have a result and an 
error margin, and it is important to have an idea of that error margin too.</p>
<p>But full portability is a much greater myth. Containers are really only guaranteed to be portable between similar systems.
They may be a little bit more portable than just a binary as you may be able to deal with missing or different libraries
in the container, but that is where it stops. Containers are usually built for a particular CPU architecture and GPU
architecture, two elements where everybody can easily see that if you change this, the container will not run. But 
there is in fact more: containers talk to other hardware too, and on an HPC system the first piece of hardware that comes
to mind is the interconnect. And they use the kernel of the host and the kernel modules and drivers provided by that
kernel. Those can be a problem. A container that is not build to support the SlingShot interconnect, may fail 
(or if you're lucky just fall back to
TCP sockets in MPI, completely killing scalability, but technically speaking still working so portable). 
Containers that expect a certain version range of a particular driver on the system may fail if a different, out-of-range
version of that driver is on the system instead (think the ROCm driver).</p>
<p>Even if a container is portable to LUMI, it may not yet be performance-portable. E.g., without proper support for the
interconnect it may still run but in a much slower mode. 
Containers that expect the knem kernel extension for good 
intra-node MPI performance may not run as efficiently as LUMI uses xpmem instead.
But one should also realise that speed gains in the x86
family over the years come to a large extent from adding new instructions to the CPU set, and that two processors
with the same instructions set extensions may still benefit from different optimisations by the compilers. 
Not using the proper instruction set extensions can have a lot of influence. At UAntwerpen we've seen GROMACS 
doubling its speed by choosing proper options, and the difference can even be bigger.</p>
<p>Many HPC sites try to build software as much as possible from sources to exploit the available hardware as much as 
possible. You may not care much about 10% or 20% performance difference on your PC, but 20% on a 160 million EURO
investment represents 32 million EURO and a lot of science can be done for that money...</p>
<h2 id="but-what-can-they-then-do-on-lumi">But what can they then do on LUMI?<a class="headerlink" href="#but-what-can-they-then-do-on-lumi" title="Permanent link">&para;</a></h2>
<figure style="border: 1px solid #000">
<p><img alt="But what can they then do on LUMI?" loading="lazy" src="https://465000095.lumidata.eu/training-materials-web/intro-202310xx/img/LUMI-BE-Intro-202310XX-11-containers/ContainersCanDoOnLUMI.png" /></p>
</figure>
<ul>
<li>
<p>A very important reason to use containers on LUMI is reducing the pressure on the file system by software
    that accesses many thousands of small files (Python and R users, you know who we are talking about).
    That software kills the metadata servers of almost any parallel file system when used at scale.</p>
<p>As a container on LUMI is a single file, the metadata servers of the parallel file system have far less 
work to do, and all the file caching mechanisms can also work much better.</p>
</li>
<li>
<p>Software installations that would otherwise be impossible. 
    E.g., some software may not even be suited for installation in
    a multi-user HPC system as it uses fixed paths that are not compatible with installation in 
    module-controlled software stacks.
    HPC systems want a lightweight <code>/usr</code> etc. structure as that part of the system
    software is often stored in a RAM disk, and to reduce boot times. Moreover, different users may need
    different versions of a software library so it cannot be installed in its default location in the system
    software region. However, some software is ill-behaved and cannot be relocated to a different directory,
    and in these cases containers help you to build a private installation that does not interfere with other
    software on the system.</p>
</li>
<li>
<p>As an example, Conda installations are not appreciated on the main Lustre file system.</p>
<p>On one hand, Conda installations tend to generate lots of small files (and then even more due to a linking
strategy that does not work on Lustre). So they need to be containerised just for storage manageability.</p>
<p>They also re-install lots of libraries that may already be on the system in a different version. 
The isolation offered by a container environment may be a good idea to ensure that all software picks up the
right versions.</p>
</li>
<li>
<p>Another example where containers have proven to be useful on LUMI is to experiment with newer versions
    of ROCm than we can offer on the system. </p>
<p>This often comes with limitations though, as (a) that ROCm version is still limited by the drivers on the 
system and (b) we've seen incompatibilities between newer ROCm versions and the Cray MPICH libraries.</p>
</li>
<li>
<p>And a combination of both: LUST with the help of AMD have prepared some containers with popular AI applications.
    These containers use some software from Conda, a newer ROCm version installed through RPMs, and some 
    performance-critical code that is compiled specifically for LUMI.</p>
</li>
</ul>
<p>Remember though that whenever you use containers, you are the system administrator and not LUST. We can impossibly
support all different software that users want to run in containers, and all possible Linux distributions they may
want to run in those containers. We provide some advice on how to build a proper container, but if you chose to
neglect it it is up to you to solve the problems that occur.</p>
<h2 id="managing-containers">Managing containers<a class="headerlink" href="#managing-containers" title="Permanent link">&para;</a></h2>
<figure style="border: 1px solid #000">
<p><img alt="Managing containers" loading="lazy" src="https://465000095.lumidata.eu/training-materials-web/intro-202310xx/img/LUMI-BE-Intro-202310XX-11-containers/ContainersManaging_1.png" /></p>
</figure>
<p>On LUMI, we currently support only one container runtime.</p>
<p>Docker is not available, and will never be on the regular compute nodes as it requires elevated privileges
to run the container which cannot be given safely to regular users of the system.</p>
<p>Singularity is currently the only supported container runtime and is available on the login nodes and
the compute nodes. It is a system command that is installed with the OS, so no module has to be loaded
to enable it. We can also offer only a single version of singularity or its close cousin AppTainer 
as singularity/AppTainer simply don't really like running multiple versions next to one another, 
and currently the version that
we offer is determined by what is offered by the OS.</p>
<p>To work with containers on LUMI you will either need to pull the container from a container registry,
e.g., <a href="https://hub.docker.com/">DockerHub</a>, or bring in the container by copying the singularity <code>.sif</code> file.</p>
<p>Singularity does offer a command to pull in a Docker container and to convert it to singularity format.
E.g., to pull a container for the Julia language from DockerHub, you'd use</p>
<div class="highlight"><pre><span></span><code>singularity<span class="w"> </span>pull<span class="w"> </span>docker://julia
</code></pre></div>
<p>Singularity uses a single flat sif file for storing containers. The <code>singularity pull</code> command does the 
conversion from Docker format to the singularity format.</p>
<p>Singularity caches files during pull operations and that may leave a mess of files in
the <code>.singularity</code> cache directory. This can lead to <strong>exhaustion of your disk quota for your
home directory</strong>. So you may want to use the environment variable <code>SINGULARITY_CACHEDIR</code>
to put the cache in, e.g,, your scratch space (but even then you want to clean up after the
pull operation so save on your storage billing units).</p>
<details class="demo" open="open">
<summary>Demo singularity pull</summary>
<p>Let's try the <code>singularity pull docker://julia</code> command:</p>
<p><!-- Used a 105x23 window size -->
<figure markdown style="border: 1px solid #000">
  <img alt="Demo singularity pull slide 1" loading="lazy" src="https://465000095.lumidata.eu/training-materials-web/intro-202310xx/img/LUMI-BE-Intro-202310XX-11-containers/ContainersExamplePull_1.png" />
</figure></p>
<p>We do get a lot of warnings but usually this is perfectly normal and usually they can be safely ignored.</p>
<p><figure markdown style="border: 1px solid #000">
  <img alt="Demo singularity pull slide 2" loading="lazy" src="https://465000095.lumidata.eu/training-materials-web/intro-202310xx/img/LUMI-BE-Intro-202310XX-11-containers/ContainersExamplePull_2.png" />
</figure></p>
<p>The process ends with the creation of the file <code>jula_latest.sif</code>. </p>
<p>Note however that the process has left a considerable number of files in <code>~/.singularity</code> also:</p>
<p><figure markdown style="border: 1px solid #000">
  <img alt="Demo singularity pull slide 3" loading="lazy" src="https://465000095.lumidata.eu/training-materials-web/intro-202310xx/img/LUMI-BE-Intro-202310XX-11-containers/ContainersExamplePull_3.png" />
</figure></p>
</details>
<figure style="border: 1px solid #000">
<p><img alt="Managing containers (2)" loading="lazy" src="https://465000095.lumidata.eu/training-materials-web/intro-202310xx/img/LUMI-BE-Intro-202310XX-11-containers/ContainersManaging_2.png" /></p>
</figure>
<p>There is currently limited support for building containers on LUMI and I do not expect that to change quickly.
Container build strategies that require elevated privileges, and even those that require fakeroot or user namespaces, cannot
be supported for security reasons (with user namespaces in particular a huge security concern as the Linux implementation
is riddled with security issues). 
Enabling features that are known to have had several serious security vulnerabilities in the recent past, or that
themselves are unsecure by design and could allow users to do more on the system than a regular user should
be able to do, will never be supported.</p>
<p>So you should pull containers from a container repository, or build the container on your own workstation
and then transfer it to LUMI.</p>
<p>There is some support for building on top of an existing singularity container.
We are also working on a number of base images to build upon, where the base images are tested with the
OS kernel on LUMI.</p>
<h2 id="interacting-with-containers">Interacting with containers<a class="headerlink" href="#interacting-with-containers" title="Permanent link">&para;</a></h2>
<figure style="border: 1px solid #000">
<p><img alt="Interacting with containers" loading="lazy" src="https://465000095.lumidata.eu/training-materials-web/intro-202310xx/img/LUMI-BE-Intro-202310XX-11-containers/ContainersInteracting.png" /></p>
</figure>
<p>There are basically three ways to interact with containers.</p>
<p>If you have the sif file already on the system you can enter the container with an interactive shell:</p>
<div class="highlight"><pre><span></span><code>singularity shell container.sif
</code></pre></div>
<details class="demo" open="open">
<summary>Demo singularity shell</summary>
<p><figure markdown style="border: 1px solid #000">
  <img alt="Demo singularity shell" loading="lazy" src="https://465000095.lumidata.eu/training-materials-web/intro-202310xx/img/LUMI-BE-Intro-202310XX-11-containers/ContainersExampleShell.png" />
</figure></p>
<p>In this screenshot we checked the contents of the <code>/opt</code> directory before and after the
<code>singularity shell julia_latest.sif</code> command. This shows that we are clearly in a different
environment. Checking the <code>/etc/os-release</code> file only confirms this as LUMI runs SUSE Linux
on the login nodes, not a version of Debian.</p>
</details>
<p>The second way is to execute a command in the container with <code>singularity exec</code>. E.g., assuming the 
container has the <code>uname</code> executable installed in it,</p>
<div class="highlight"><pre><span></span><code>singularity exec container.sif uname -a
</code></pre></div>
<details class="demo" open="open">
<summary>Demo singularity exec</summary>
<p><figure markdown style="border: 1px solid #000">
  <img alt="Demo singularity exec" loading="lazy" src="https://465000095.lumidata.eu/training-materials-web/intro-202310xx/img/LUMI-BE-Intro-202310XX-11-containers/ContainersExampleExec.png" />
</figure></p>
<p>In this screenshot we execute the <code>uname -a</code> command before and with the
<code>singularity exec julia_latest.sif</code> command. There are some slight differences in the
output though the same kernel version is reported as the container uses the host kernel.
Executing</p>
<div class="highlight"><pre><span></span><code>singularity exec julia_latest.sif cat /etc/os-release
</code></pre></div>
<p>confirms though that the commands are executed in the container.</p>
</details>
<p>The third option is often called running a container, which is done with singularity run:</p>
<div class="highlight"><pre><span></span><code>singularity run container.sif
</code></pre></div>
<p>It does require the container to have a special script that tells singularity what 
running a container means. You can check if it is present and what it does with <code>singularity inspect</code>: </p>
<div class="highlight"><pre><span></span><code>singularity inspect --runscript container.sif
</code></pre></div>
<details class="demo" open="open">
<summary>Demo singularity run</summary>
<p><figure markdown style="border: 1px solid #000">
  <img alt="Demo singularity run" loading="lazy" src="https://465000095.lumidata.eu/training-materials-web/intro-202310xx/img/LUMI-BE-Intro-202310XX-11-containers/ContainersExampleRun.png" />
</figure></p>
<p>In this screenshot we start the julia interface in the container using
<code>singularity run</code>. The second command shows that the container indeed
includes a script to tell singularity what <code>singularity run</code> should do.</p>
</details>
<p>You want your container to be able to interact with the files in your account on the system.
Singularity will automatically mount <code>$HOME</code>, <code>/tmp</code>, <code>/proc</code>, <code>/sys</code> and <code>dev</code> in the container,
but this is not enough as your home directory on LUMI is small and only meant to be used for
storing program settings, etc., and not as your main work directory. (And it is also not billed
and therefore no extension is allowed.) Most of the time you want to be able to access files in
your project directories in <code>/project</code>, <code>/scratch</code> or <code>/flash</code>, or maybe even in <code>/appl</code>.
To do this you need to tell singularity to also mount these directories in the container,
either using the 
<code>--bind src1:dest1,src2:dest2</code> 
flag or via the <code>SINGULARITY_BIND</code> or <code>SINGULARITY_BINDPATH</code> environment variables.
E.g.,</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">SINGULARITY_BIND</span><span class="o">=</span><span class="s1">&#39;/pfs,/scratch,/projappl,/project,/flash&#39;</span>
</code></pre></div>
<p>will ensure that you have access to the scratch, project and flash directories of your project.</p>
<h2 id="running-containers-on-lumi">Running containers on LUMI<a class="headerlink" href="#running-containers-on-lumi" title="Permanent link">&para;</a></h2>
<figure style="border: 1px solid #000">
<p><img alt="/running containers on LUMI" loading="lazy" src="https://465000095.lumidata.eu/training-materials-web/intro-202310xx/img/LUMI-BE-Intro-202310XX-11-containers/ContainersRunning.png" /></p>
</figure>
<p>Just as for other jobs, you need to use Slurm to run containers on the compute nodes.</p>
<p>For MPI containers one should use <code>srun</code> to run the <code>singularity exec</code> command, e.g,,</p>
<div class="highlight"><pre><span></span><code>srun singularity exec --bind ${BIND_ARGS} \
${CONTAINER_PATH} mp_mpi_binary ${APP_PARAMS}
</code></pre></div>
<p>(and replace the environment variables above with the proper bind arguments for <code>--bind</code>, container file and
parameters for the command that you want to run in the container).</p>
<p>On LUMI, the software that you run in the container should be compatible with Cray MPICH, i.e., use the
MPICH ABI (currently Cray MPICH is based on MPICH 3.4). It is then possible to tell the container to use
Cray MPICH (from outside the container) rather than the MPICH variant installed in the container, so that
it can offer optimal performance on the LUMI SlingShot 11 interconnect.</p>
<p>Open MPI containers are currently not well supported on LUMI and we do not recommend using them.
We only have a partial solution for the CPU nodes that is not tested in all scenarios, 
and on the GPU nodes Open MPI is very problematic at the moment.
This is due to some design issues in the design of Open MPI, and also to some piece of software
that recent versions of Open MPI require but that HPE only started supporting recently on Cray EX systems
and that we haven't been able to fully test.
Open MPI has a slight preference for the UCX communication library over the OFI libraries, and 
currently full GPU support requires UCX. Moreover, binaries using Open MPI often use the so-called
rpath linking process so that it becomes a lot harder to inject an Open MPI library that is installed
elsewhere. The good news though is that the Open MPI developers of course also want Open MPI
to work on biggest systems in the USA, and all three currently operating or planned exascale systems
use the SlingShot 11 interconnect, so work is going on for better support for OFI and for full GPU
support on systems that rely on OFI and do not support UCX.</p>
<h2 id="enhancements-to-the-environment">Enhancements to the environment<a class="headerlink" href="#enhancements-to-the-environment" title="Permanent link">&para;</a></h2>
<figure style="border: 1px solid #000">
<p><img alt="Environment enhancements" loading="lazy" src="https://465000095.lumidata.eu/training-materials-web/intro-202310xx/img/LUMI-BE-Intro-202310XX-11-containers/ContainersEnvironmentEnhancement_1.png" /></p>
</figure>
<p>To make life easier, LUST with the support of CSC did implement some modules
that are either based on containers or help you run software with containers.</p>
<h3 id="bindings-for-singularity">Bindings for singularity<a class="headerlink" href="#bindings-for-singularity" title="Permanent link">&para;</a></h3>
<p>The <strong><code>singularity-bindings/system</code></strong> module which can be installed via EasyBuild
helps to set <code>SINGULARITY_BIND</code> and <code>SINGULARITY_LD_LIBRARY_PATH</code> to use 
Cray MPICH. Figuring out those settings is tricky, and sometimes changes to the
module are needed for a specific situation because of dependency conflicts
between Cray MPICH and other software in the container, which is why we don't
provide it in the standard software stacks but instead make it available as
an EasyBuild recipe that you can adapt to your situation and install.</p>
<p>As it needs to be installed through EasyBuild, it is really meant to be 
used in the context of a LUMI software stack (so not in <code>CrayEnv</code>).
To find the EasyConfig files, load the <code>EasyBuild-user</code> module and 
run</p>
<div class="highlight"><pre><span></span><code>eb --search singularity-bindings
</code></pre></div>
<p>You can also check the 
<a href="https://lumi-supercomputer.github.io/LUMI-EasyBuild-docs/s/singularity-bindings/">page for the <code>singularity-bindings</code> in the LUMI Software Library</a>.</p>
<p>You may need to change the EasyConfig for your specific purpose though.
E.g., the singularity command line option <code>--rocm</code> to import the ROCm installation
from the system doesn't fully work (and in fact, as we have alternative ROCm versions
on the system cannot work in all cases) but that can also be fixed by extending
the <code>singularity-bindings</code> module 
(or by just manually setting the proper environment variables).</p>
<h3 id="vnc-container">VNC container<a class="headerlink" href="#vnc-container" title="Permanent link">&para;</a></h3>
<p>The second tool is a container that we provide with some bash functions
to start a VNC server as temporary way to be able to use some GUI programs
on LUMI until the final setup which will be based on Open OnDemand is ready (expected late 2023).
It can be used in <code>CrayEnv</code> or in the LUMI stacks through the
<a href="https://lumi-supercomputer.github.io/LUMI-EasyBuild-docs/l/lumi-vnc/"><strong><code>lumi-vnc</code></strong> module</a>. 
The container also
contains a poor men's window manager (and yes, we know that there are sometimes
some problems with fonts). It is possible to connect to the VNC server either
through a regular VNC client on your PC or a web browser, but in both cases you'll
have to create an ssh tunnel to access the server. Try</p>
<div class="highlight"><pre><span></span><code>module help lumi-vnc
</code></pre></div>
<p>for more information on how to use <code>lumi-vnc</code>.</p>
<h3 id="cotainr-build-conda-containers-on-lumi">cotainr: Build Conda containers on LUMI<a class="headerlink" href="#cotainr-build-conda-containers-on-lumi" title="Permanent link">&para;</a></h3>
<figure style="border: 1px solid #000">
<p><img alt="Environment enhancements (2)" loading="lazy" src="https://465000095.lumidata.eu/training-materials-web/intro-202310xx/img/LUMI-BE-Intro-202310XX-11-containers/ContainersEnvironmentEnhancement_2.png" /></p>
</figure>
<p>The third tool is <a href="https://lumi-supercomputer.github.io/LUMI-EasyBuild-docs/c/cotainr/"><strong><code>cotainr</code></strong></a>, 
a tool developed by DeIC, the Danish partner in the LUMI consortium.
It is a tool to pack a Conda installation into a container. It runs entirely in user space and doesn't need
any special rights. (For the container specialists: It is based on the container sandbox idea to build
containers in user space.)</p>
<h3 id="container-wrapper-for-python-packages-and-conda">Container wrapper for Python packages and conda<a class="headerlink" href="#container-wrapper-for-python-packages-and-conda" title="Permanent link">&para;</a></h3>
<p>The fourth tool is a container wrapper tool that users from Finland may also know
as Tykky. It is a tool to wrap Python and conda installations in a container and then
create wrapper scripts for the commands in the bin subdirectory so that for most
practical use cases the commands can be used without directly using singularity
commands. 
Whereas cotainr fully exposes the container to users and its software is accessed
through the regular singularity commands, Tykky tries to hide this complexity with
wrapper scripts that take care of all bindings and calling singularity.
On LUMI, it is provided by the <strong><code>lumi-container-wrapper</code></strong>
module which is available in the <code>CrayEnv</code> environment and in the LUMI software stacks.
It is also <a href="https://docs.lumi-supercomputer.eu/software/installing/container-wrapper/">documented in the LUMI documentation</a>.</p>
<p>The basic idea is that you run the tool to either do a conda installation or an installation
of Python packages from a file that defines the environment in either standard conda
format (a Yaml file) or in the <code>requirements.txt</code> format used by <code>pip</code>. </p>
<p>The container wrapper will then perform the installation in a work directory, create some
wrapper commands in the <code>bin</code> subdirectory of the directory where you tell the container
wrapper tool to do the installation, and it will use SquashFS to create as single file
that contains the conda or Python installation.</p>
<p>We do strongly recommend to use the container wrapper tool for larger conda and Python installation.
We will not raise your file quota if it is to house such installation in your <code>/project</code> directory.</p>
<details class="demo" open="open">
<summary>Demo lumi-container-wrapper</summary>
<p>Create a subdirectory to experiment. In that subdirectory, create a file named <code>env.yml</code> with
the content:</p>
<div class="highlight"><pre><span></span><code>channels:
  - conda-forge
dependencies:
  - python=3.8.8
  - scipy
  - nglview
</code></pre></div>
<p>and create an empty subdirectory <code>conda-cont-1</code>.</p>
<p>Now you can follow the commands on the slides below:</p>
<p><figure markdown style="border: 1px solid #000">
  <img alt="demo lumi-container-wrapper slide 1" loading="lazy" src="https://465000095.lumidata.eu/training-materials-web/intro-202310xx/img/LUMI-BE-Intro-202310XX-11-containers/ContainersExampleWrapper_1.png" />
</figure></p>
<p>On the slide above we prepared the environment.</p>
<p>Now lets run the command </p>
<div class="highlight"><pre><span></span><code>conda-containerize new --prefix ./conda-cont-1 env.yml
</code></pre></div>
<p>and look at the output that scrolls over the screen.
The screenshots don't show the full output as some parts of the screen get overwritten during
the process:</p>
<p><figure markdown style="border: 1px solid #000">
  <img alt="demo lumi-container-wrapper slide 2" loading="lazy" src="https://465000095.lumidata.eu/training-materials-web/intro-202310xx/img/LUMI-BE-Intro-202310XX-11-containers/ContainersExampleWrapper_2.png" />
</figure></p>
<p>The tool will first build the conda installation in a tempororary work directory
and also uses a base container for that purpose.</p>
<p><figure markdown style="border: 1px solid #000">
  <img alt="demo lumi-container-wrapper slide 3" loading="lazy" src="https://465000095.lumidata.eu/training-materials-web/intro-202310xx/img/LUMI-BE-Intro-202310XX-11-containers/ContainersExampleWrapper_3.png" />
</figure></p>
<p>The conda installation itself though is stored in a SquashFS file that is then
used by the container.</p>
<p><figure markdown style="border: 1px solid #000">
  <img alt="demo lumi-container-wrapper slide 4" loading="lazy" src="https://465000095.lumidata.eu/training-materials-web/intro-202310xx/img/LUMI-BE-Intro-202310XX-11-containers/ContainersExampleWrapper_4.png" />
</figure></p>
<p><figure markdown style="border: 1px solid #000">
  <img alt="demo lumi-container-wrapper slide 65" loading="lazy" src="https://465000095.lumidata.eu/training-materials-web/intro-202310xx/img/LUMI-BE-Intro-202310XX-11-containers/ContainersExampleWrapper_5.png" />
</figure></p>
<p>In the slide above we see the installation contains both a singularity container
and a SquashFS file. They work together to get a working conda installation.</p>
<p>The <code>bin</code> directory seems to contain the commands, but these are in fact scripts 
that run those commands in the container with the SquashFS file system mounted in it.</p>
<p><figure markdown style="border: 1px solid #000">
  <img alt="demo lumi-container-wrapper slide 6" loading="lazy" src="https://465000095.lumidata.eu/training-materials-web/intro-202310xx/img/LUMI-BE-Intro-202310XX-11-containers/ContainersExampleWrapper_6.png" />
</figure></p>
<p>So as you can see above, we can simply use the <code>python3</code> command without realising
what goes on behind the screen...</p>
</details>
<p>The wrapper module also offers a pip-based command to build upon the Cray Python modules already present on the system</p>
<h3 id="pre-build-ai-containers">Pre-build AI containers<a class="headerlink" href="#pre-build-ai-containers" title="Permanent link">&para;</a></h3>
<p><strong>This is work in progress and not yet available when this text was written. 
The information below is preliminary. More information will follow.</strong></p>
<figure style="border: 1px solid #000">
<p><img alt="Environment enhancements (3): Prebuilt AI containers" loading="lazy" src="https://465000095.lumidata.eu/training-materials-web/intro-202310xx/img/LUMI-BE-Intro-202310XX-11-containers/ContainersPrebuiltAI.png" /></p>
</figure>
<p>LUST with the help of AMD is also building some containers with popular AI software.
These containers contain a ROCm version that is appropriate for the software,
use Conda for some components, but have several of the performance critical components
built specifically for LUMI for near-optimal performance. Depending on the software they
also contain a RCCL library with the appropriate plugin to work well on the Slingshot 11
interconnect, or a horovod compiled to use Cray MPICH. </p>
<p>The containers are provided through a module which sets the <code>SINGULARITY_BIND</code> environment variable
to ensure proper bindings (as they need, e.g., the libfabric library from the system and the proper
"CXI provider" for libfabric to connect to the Slingshot interconnect). The module will also provide
an environment variable to refer to the container (name with full path) to make it easy to refer to
the container in job scripts.</p>
<p>These containers can be found through the
<a href="https://lumi-supercomputer.github.io/LUMI-EasyBuild-docs/">LUMI Software Library</a> and are marked
with a container label.</p>
<h2 id="conclusion-container-limitations-on-lumi">Conclusion: Container limitations on LUMI<a class="headerlink" href="#conclusion-container-limitations-on-lumi" title="Permanent link">&para;</a></h2>
<figure style="border: 1px solid #000">
<p><img alt="Container limitations on LUMI" loading="lazy" src="https://465000095.lumidata.eu/training-materials-web/intro-202310xx/img/LUMI-BE-Intro-202310XX-11-containers/ContainersLimitations.png" /></p>
</figure>
<p>To conclude the information on using singularity containers on LUMI,
we want to repeat the limitations:</p>
<ul>
<li>
<p>Containers use the host's operating system kernel which is likely different and
    may have different drivers and kernel extensions than your regular system.
    This may cause the container to fail or run with poor performance.
    Also, containers do not abstract the hardware unlike some virtual machine solutions.</p>
</li>
<li>
<p>The LUMI hardware is almost certainly different from that of the systems on which
    you may have used the container before and that may also cause problems.</p>
<p>In particular a generic container may not offer sufficiently good support for the 
SlingShot 11 interconnect on LUMI which requires OFI (libfabric) with the right 
network provider (the so-called Cassini provider) for optimal performance.
The software in the container may fall back to TCP sockets resulting in poor 
performance and scalability for communication-heavy programs.</p>
<p>For containers with an MPI implementation that follows the MPICH ABI the solution
is often to tell it to use the Cray MPICH libraries from the system instead.</p>
<p>Likewise, for containers for distributed AI, one may need to inject an appropriate
RCCL plugin to fully use the SlingShot 11 interconnect.</p>
</li>
<li>
<p>As containers rely on drivers in the kernel of the host OS, the AMD driver may also
    cause problems. AMD only guarantees compatibility of the driver with two minor versions
    before and after the ROCm release for which the driver was meant. Hence containers 
    using a very old version of ROCm or a very new version compared to what is available
    on LUMI, may not always work as expected.</p>
</li>
<li>
<p>The support for building containers on LUMI is currently very limited due to security
    concerns. Any build process that requires elevated privileges, fakeroot or user namespaces
    will not work.</p>
</li>
</ul>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        

<footer class="md-footer">
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
          <img alt="Creative Commons License" 
              style="border-width:0" 
              src="https://i.creativecommons.org/l/by/4.0/80x15.png"
          />
        </a>
        This work is licensed under a&nbsp;
        <a rel="license" 
          href="http://creativecommons.org/licenses/by/4.0/"
        >
          Creative Commons Attribution 4.0 International License
        </a>
      </div>      
      <div class="md-social">
  
</div>
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.top", "navigation.indexes", "header.autohide", "toc.follow"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c14ae12.min.js"></script>
      
    
  </body>
</html>